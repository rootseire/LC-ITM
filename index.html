<!DOCTYPE html>
<meta charset="utf-8">
<title>SANKEY Experiment</title>
<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:700" rel="stylesheet">
<style>
 
.node rect {
  cursor: move;
  fill-opacity: .9;
  shape-rendering: crispEdges;
}
 
.node text {
  pointer-events: none;
  /*text-shadow: 0 1px 0 #fff;*/
}
 
.link {
  fill: none;
  stroke: #000;
  stroke-opacity: .2;
}
 
.link:hover {
  stroke-opacity: .5;
}
    body{
        background-color:#f5f5f5;
    }
div{    
    margin: 0 auto;
    width: 100%;
    text-align: center;}
p{    
    margin: 0 auto;
    width: 1000px;
    padding:15px!important;
    font-size:18px!important;
}
    
h1, h2{    
    margin: 0 auto;
    width: 1000px;
    color:#141e30;
    text-align:center;
    }
  
iframe{
        height:570px!important;
    }    
.tableauPlaceholder{
        height:570px!important;
    }
    .quotationBlock[data-v-ad5fa5ec]:after {
    content: close-quote;
    position: absolute;
    right: -30px;
    bottom: 0;
    font-weight: 700;
    font-size: 60px;
    color: #141e30;
        
}
.quotationBlock[data-v-ad5fa5ec]:before {
    content: open-quote;
    position: absolute;
    left: -30px;
    top: 0;
    font-weight: 700;
    font-size: 60px;
    color: #141e30;
}
p[data-v-ad5fa5ec] {
    font-family: Georgia;
    background-color: #fff;
    padding: 10px;
    font-size: 18px;
    line-height: 1.2;
    width: 50%;
    border-radius: 5px;
    margin: 20px auto;
    color: #000;
    text-align: left;
}
    .quotationBlock[data-v-ad5fa5ec] {
        width:50%;
    color: #141e30;
    position: relative;
    quotes: "\201C" "\201D" "\2018" "\2019";
    }
    .quotationBlock{
         width:50%;  
        
    }
    .statement{
         width:50%;
        padding-bottom:50px!important;
    }
    h1{
    font-family: 'IBM Plex Sans', sans-serif;
    font-size: 66px;
    padding: 20px;
    }
    span{text-align:right;}
    svg{overflow:visible;
        /* 
    background-image: url('https://raw.githubusercontent.com/rootseire/LC-ITM/master/BG.png');
    background-position-x: -152px;*/
    }
</style>
<body>
    
    <h1>Irish Traditional Music at the AFC </h1>
    <h2>- <a href="https://www.twitter.com/mrpatrickegan">Patrick Egan </a></h2>
    
    <p data-v-ad5fa5ec="" class="quotationBlock">Listening to multiple versions of an Irish folksong posted by many different fieldworkers over many different regions and years - and programatically denying priority to any single one - will go a long way toward providing a facsimile, eAccurate sense of the song's many-sided, irreducible character. eAccuracy is like a video continuously being shot and (re)-edited rather than a photograph filed in a shoebox. <span data-v-ad5fa5ec=""><a data-v-ad5fa5ec="" href="https://www.press.uillinois.edu/books/catalog/54xcf5ha9780252037184.html">Miles Foley</a>, 2012</span></p>
    
    <p data-v-ad5fa5ec="" class="quotationBlock">Oral Tradition and Internet - Despite superficial differences, both technologies are radically alike in depending not on static products but on continuous processes, not on "What?" but on "How do I get there?" In contrast to the fixed spatial organization of the page and book, the technologies of oral tradition and the internet mime the way we think by processing along pathways within a network. In both media it's path-ways-not things-that matter. <span data-v-ad5fa5ec=""><a data-v-ad5fa5ec="" href="https://www.press.uillinois.edu/books/catalog/54xcf5ha9780252037184.html">Miles Foley</a>, 2012</span></p>
    
 <p class="statement">As a Library of Congress Kluge Scholar, I have begun diving into the collections of the American Folklife Center (AFC) at the Library. Some of my initial forays have been brought together and shared in this post.</p>

<p class="statement">My first activity at the AFC was to survey their audio collections. I began this quest by asking the question: Where are the field recordings of Irish traditional music located in all collections across the Center. I wanted to explore common identifiers between tunes, songs and dances that were performed, collected and archived in a wide range of ways. How might performances and collecting have changed over the years, and what digital technologies might performers of Irish traditional music in North America now use to access and navigate these collections?</p>


    <br />
    
    
     <div class='tableauPlaceholder' id='viz1553292246487' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Au&#47;AudioRecordingsofITMattheAmericanFolklifeCenter&#47;Sheet1&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='AudioRecordingsofITMattheAmericanFolklifeCenter&#47;Sheet1' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Au&#47;AudioRecordingsofITMattheAmericanFolklifeCenter&#47;Sheet1&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='filter' value='publish=yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1553292246487');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>

    <h1>Pathways to the recordings</h1>
    
    <p class="statement"> The following chart illustrates both access points to the collections which contain Irish traditional music, but also the types of material that can be found in each specific collection. On the left is each item, moving progressively towards the collections themselves and the physical recordings contained within them. On the right hand side is shown the access points for each collection. </p>
    
    
    
<p id="chart">
 
<script src="https://d3js.org/d3.v3.js"></script>
<script src="sankey.js"></script>
<script>
  
var units = "Recordings";
var heightAdd = 30;
var margin = {top: 10, right: 10, bottom: 10, left: 10},
    width = 1000 - margin.left - margin.right,
    height = 600 - margin.top - margin.bottom;
 
var formatNumber = d3.format(",.0f"),    // zero decimal places
    format = function(d) { return formatNumber(d) + " " + units; },
    color = d3.scale.category20();
 
// append the svg canvas to the page
var svg = d3.select("#chart").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", 
          "translate(" + margin.left + "," + margin.top + ")");
 
// Set the sankey diagram properties
var sankey = d3.sankey()
    .nodeWidth(36)
    .nodePadding(10)
    .size([width, height]);
 
var path = sankey.link();
 
// load the data
d3.json("sankey14march.json", function(error, graph) {
 
    var nodeMap = {};
    graph.nodes.forEach(function(x) { nodeMap[x.name] = x; });
    graph.links = graph.links.map(function(x) {
      return {
        source: nodeMap[x.source],
        target: nodeMap[x.target],
        value: x.value
      };
    });
 
  sankey
      .nodes(graph.nodes)
      .links(graph.links)
      .layout(32);
 
// add in the links
  var link = svg.append("g").selectAll(".link")
      .data(graph.links)
    .enter().append("path")
      .attr("class", "link")
      .attr("d", path)
      .style("stroke-width", function(d) { return Math.max(1, d.dy); })
      .sort(function(a, b) { return b.dy - a.dy; });
      
 
// add the link titles
  link.append("title")
        .text(function(d) {
      	return d.source.name + " â†’ " + 
                d.target.name + "\n" + format(d.value); });
 
// add in the nodes
  var node = svg.append("g").selectAll(".node")
      .data(graph.nodes)
    .enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { 
	  return "translate(" + d.x + "," + d.y + ")"; })
   .call(function () {
      manualLayout();
    })
 
  
    .call(d3.behavior.drag()
      .origin(function(d) { return d; })
      .on("dragstart", function() { 
		  this.parentNode.appendChild(this); })
      .on("drag", dragmove));
 
// add the rectangles for the nodes
  node.append("rect")
    
      .attr("height", function(d) { return d.dy; })
      .attr("width", sankey.nodeWidth())
      .style("fill", function(d) {
      
		  return d.color = color(d.name.replace(/ .*/, "")); })
    
      .style("stroke", function(d) { 
		  return d3.rgb(d.color).darker(2); })
    .append("title")
      .text(function(d) { 
		  return d.name + "\n" + format(d.value); });
 
// add in the title for the nodes
  node.append("text")
      .attr("x", 40)
      .attr("y", function(d) { return d.dy / 2; })
      .attr("dy", ".35em")
      .attr("text-anchor", "start")
      .attr("transform", null)
      .text(function(d) { return d.name; })
    .filter(function(d) { return d.x < width / 2; })
      .attr("x", 6 + sankey.nodeWidth())
      .attr("x", function(d){
      if (d.name == 'Jigs' || d.name == 'Reels' || d.name == 'Songs'|| d.name == 'Dances' || d.name == 'Gavottes'|| d.name == 'Varsouviana' || d.name == 'Waltzes' || d.name == 'Barndances' || d.name == 'Quadrilles' || d.name == 'Slip Jigs' || d.name == 'Stories'|| d.name == 'Hornpipes' || d.name == 'Slow Airs'|| d.name == 'Marches' || d.name == 'Slides'|| d.name == 'Schottisches' || d.name == 'Air'|| d.name == 'Polkas' || d.name == 'Set Dances'|| d.name == 'Flings') {
    //.attr("x", 6 + sankey.nodeWidth())
      return -40 + sankey.nodeWidth();
           }
      
     else if(d.name == 'CD Disc' || d.name == 'On External Website' || d.name == 'Catalog Cards'|| d.name == 'On Demand Listening'|| d.name == 'Finding Aid Online'|| d.name == 'LOC Website'|| d.name == 'Audio Cassette Player'|| d.name == 'Reel to Reel Player'){
        return -40 + sankey.nodeWidth();
  }else if(d.name == 'Wax Cylinder' || d.name == 'Reel to Reel' || d.name == '78-rpm Disc'){
       return -40 + sankey.nodeWidth();
		   }
      
     else{
      return 6 + sankey.nodeWidth();
  }
  })
    .attr("text-anchor", function(d) {
      if(d.name == 'CD Disc' || d.name == 'On External Website' || d.name == 'Catalog Cards' || d.name == 'On Demand Listening' || d.name == 'Finding Aid Online'|| d.name == 'LOC Website'|| d.name == 'Audio Cassette Player'|| d.name == 'Reel to Reel Player'){
      return "start";
    }
      else if (d.name == 'Jigs' || d.name == 'Reels' || d.name == 'Songs'|| d.name == 'Dances' || d.name == 'Gavottes'|| d.name == 'Varsouviana' || d.name == 'Waltzes' || d.name == 'Barndances' || d.name == 'Quadrilles' || d.name == 'Slip Jigs' || d.name == 'Stories'|| d.name == 'Hornpipes' || d.name == 'Slow Airs'|| d.name == 'Marches' || d.name == 'Slides'|| d.name == 'Schottisches' || d.name == 'Air'|| d.name == 'Polkas' || d.name == 'Set Dances'|| d.name == 'Flings') {
        return "end";//on condition match
      }
      else if(d.name == 'Wax Cylinder' || d.name == 'Reel to Reel' || d.name == '78-rpm Disc'){
       return "middle";
		   }
    else{
      //return "start";
  }})
    
        

    
      //.attr("text-anchor", "start");
 
// the function for moving the nodes
  function dragmove(d) {
    d3.select(this).attr("transform", 
        "translate(" + (
        	   d.x = Math.max(0, Math.min(width - d.dx, d3.event.x))
        	) + "," + (
                   d.y = Math.max(0, Math.min(height - d.dy, d3.event.y))
            ) + ")");
    sankey.relayout();
    link.attr("d", path);
  }

 
    
    
    function manualLayout() {
    //http://stackoverflow.com/questions/10337640/how-to-access-the-dom-element-that-correlates-to-a-d3-svg-object
    //displacements in order of foo nodes (foo[0][j])
    var displacements = [0,40,80,120,160,200,240,260];
    var foo = d3.selectAll("g.node");
    for (j=0; j < displacements.length; j++) {
      pickNode = foo[0][j]; //equals "this" in d3.behavior.drag()...on("dragstart")
      d = graph.nodes[j];
      d3.select(pickNode).attr("transform", 
            "translate(" + (
                   d.x = d.x
          ) + "," + (
                   d.y = displacements[j] //Math.max(0, Math.min(height - d.dy, d3.event.y))
            ) + ")");
   
    }
    sankey.relayout();
    link.attr("d", path);
  }
    });
</script>
    
    <p class="statement">The following chart illustrates both access points to the collections which contain Irish traditional music, but also the types of material that can be found in each specific collection. On the left is each item, moving progressively towards the collections themselves and the physical recordings contained within them. On the right hand side is shown the access points for each collection. </p>

</body>
</html>